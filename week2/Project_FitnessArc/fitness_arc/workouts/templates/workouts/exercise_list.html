{% extends "base.html" %}
{% block title %}Exercices{% endblock %}
{% block content %}
<h1>Exercices</h1>

<p>Nombre d'exercices : {{ exercises.count }}</p>

<form method="get" id="filterForm" style="margin-bottom:1rem">
  <label>Muscle:
    <select name="muscle" onchange="document.getElementById('filterForm').submit()">
      <option value="">-- Tous --</option>
      <option value="chest" {% if request.GET.muscle == 'chest' %}selected{% endif %}>Pectoraux</option>
      <option value="back" {% if request.GET.muscle == 'back' %}selected{% endif %}>Dos</option>
      <option value="legs" {% if request.GET.muscle == 'legs' %}selected{% endif %}>Jambes</option>
      <option value="shoulders" {% if request.GET.muscle == 'shoulders' %}selected{% endif %}>Épaules</option>
      <option value="arms" {% if request.GET.muscle == 'arms' %}selected{% endif %}>Bras</option>
      <option value="core" {% if request.GET.muscle == 'core' %}selected{% endif %}>Abdos</option>
    </select>
  </label>
  <label>Équipement:
    <select name="equip" onchange="document.getElementById('filterForm').submit()">
      <option value="">-- Tous --</option>
      <option value="barbell" {% if request.GET.equip == 'barbell' %}selected{% endif %}>Barre</option>
      <option value="dumbbell" {% if request.GET.equip == 'dumbbell' %}selected{% endif %}>Haltères</option>
      <option value="machine" {% if request.GET.equip == 'machine' %}selected{% endif %}>Machine</option>
      <option value="bodyweight" {% if request.GET.equip == 'bodyweight' %}selected{% endif %}>Poids du corps</option>
    </select>
  </label>
  {% if request.GET.muscle or request.GET.equip %}
    <a href="{% url 'workouts:exercise_list' %}" class="btn" style="background:#6c757d">Réinitialiser</a>
  {% endif %}
</form>

<div class="card">
  {% if exercises %}
    <table style="width:100%">
      <thead>
        <tr><th>Image</th><th>Nom</th><th>Muscle</th><th>Équipement</th><th>Difficulté</th></tr>
      </thead>
      <tbody>
        {% for ex in exercises %}
          <tr>
            <td>
              {% if ex.image %}
                <img src="{{ MEDIA_URL }}{{ ex.image }}" alt="{{ ex.name }}" style="width:80px;height:80px;object-fit:cover;border-radius:8px;">
              {% else %}
                <div style="width:80px;height:80px;background:#ddd;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#999;">
                  <span>?</span>
                </div>
              {% endif %}
            </td>
            <td><strong>{{ ex.name }}</strong></td>
            <td>{{ ex.get_muscle_group_display }}</td>
            <td>{{ ex.get_equipment_display }}</td>
            <td>{{ ex.difficulty }}/5</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p style="padding:1rem; text-align:center; color:#999;">
      ❌ Aucun exercice trouvé.
    </p>
  {% endif %}
</div>
{% endblock %}
