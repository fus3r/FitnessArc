<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Fitness Arc{% endblock %}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{
      --primary:#6366f1;--secondary:#8b5cf6;--accent:#ec4899;
      --success:#10b981;--warning:#f59e0b;--danger:#ef4444;
      --bg:#0a0a0f;--bg-elevated:#12121a;--bg-card:#1a1a24;
      --text:#e5e7eb;--text-dim:#9ca3af;--border:#1f2937;
    }
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    @keyframes slideIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    @keyframes float{0%,100%{transform:translateY(0px)}50%{transform:translateY(-20px)}}
    @keyframes rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    body{
      font-family:'Inter',sans-serif;
      background:linear-gradient(135deg,#0a0a0f 0%,#1a0f2e 25%,#0f1a2e 50%,#0a0a0f 100%);
      background-size:400% 400%;
      animation:fadeIn 0.4s ease;
      color:var(--text);min-height:100vh;font-size:15px;line-height:1.6;
      -webkit-font-smoothing:antialiased;position:relative;overflow-x:hidden;
    }
    body::before{
      content:'';position:fixed;top:-50%;left:-50%;width:200%;height:200%;
      background:
        radial-gradient(circle at 20% 30%,rgba(99,102,241,0.15),transparent 25%),
        radial-gradient(circle at 80% 70%,rgba(139,92,246,0.12),transparent 25%),
        radial-gradient(circle at 50% 50%,rgba(236,72,153,0.08),transparent 30%);
      pointer-events:none;z-index:0;
      animation:rotate 60s linear infinite;
    }
    body::after{
      content:'';position:fixed;top:0;left:0;right:0;bottom:0;
      background:
        linear-gradient(45deg,transparent 30%,rgba(99,102,241,0.03) 50%,transparent 70%),
        linear-gradient(-45deg,transparent 30%,rgba(139,92,246,0.03) 50%,transparent 70%);
      background-size:200% 200%;
      pointer-events:none;z-index:0;
      animation:float 15s ease-in-out infinite;
    }
    header{
      background:rgba(18,18,26,0.7);backdrop-filter:blur(30px) saturate(180%);
      border-bottom:1px solid rgba(99,102,241,0.15);
      position:sticky;top:0;z-index:100;
      box-shadow:0 8px 32px rgba(0,0,0,0.3);
    }
    nav{
      max-width:1600px;margin:0 auto;padding:1rem 2.5rem;
      display:flex;align-items:center;justify-content:space-between;
    }
    .nav-brand{
      display:flex;align-items:center;gap:0.75rem;
    }
    .nav-brand-logo{
      width:36px;height:36px;border-radius:10px;
      background:linear-gradient(135deg,var(--primary),var(--secondary));
      display:flex;align-items:center;justify-content:center;
      font-weight:900;font-size:1.25rem;color:#fff;
      box-shadow:0 4px 12px rgba(99,102,241,0.4);
    }
    .nav-brand-text{
      font-size:1.25rem;font-weight:800;
      background:linear-gradient(135deg,var(--primary),var(--accent));
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      background-clip:text;letter-spacing:-0.02em;
    }
    .nav-center{
      display:flex;align-items:center;gap:0.5rem;
      background:rgba(26,26,36,0.6);padding:0.5rem;
      border-radius:50px;border:1px solid rgba(99,102,241,0.2);
    }
    .nav-center a{
      color:var(--text-dim);text-decoration:none;font-weight:500;
      font-size:14px;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
      padding:0.625rem 1.25rem;border-radius:30px;white-space:nowrap;
      position:relative;
    }
    .nav-center a.active{
      background:linear-gradient(135deg,var(--primary),var(--secondary));
      color:#fff;box-shadow:0 4px 16px rgba(99,102,241,0.5);
    }
    .nav-center a:not(.active):hover{
      color:var(--text);background:rgba(51,65,85,0.5);
      transform:translateY(-2px);
    }
    .nav-right{
      display:flex;align-items:center;gap:1rem;
    }
    .nav-friends-icon{
      position:relative;
    }
    .nav-friends-icon a{
      display:flex;align-items:center;justify-content:center;
      width:40px;height:40px;border-radius:50%;
      background:rgba(26,26,36,0.6);border:1px solid rgba(99,102,241,0.2);
      transition:all 0.2s;text-decoration:none;
    }
    .nav-friends-icon svg{
      color:var(--primary);
    }
    .nav-friends-icon .pending-requests-count{
      position:absolute;top:-4px;right:-4px;
      background:var(--danger);color:#fff;
      width:18px;height:18px;border-radius:50%;
      font-size:10px;font-weight:700;
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 2px 8px rgba(239,68,68,0.5);
    }
    .nav-user-dropdown{
      position:relative;
    }
    .nav-user{
      display:flex;align-items:center;gap:0.75rem;
      padding:0.5rem 1rem 0.5rem 0.5rem;
      background:rgba(26,26,36,0.6);border-radius:50px;
      border:1px solid rgba(99,102,241,0.2);
      transition:all 0.2s;cursor:pointer;
    }
    .nav-user:hover{border-color:rgba(99,102,241,0.4)}
    .nav-avatar{
      width:36px;height:36px;border-radius:50%;
      background:linear-gradient(135deg,var(--primary),var(--accent));
      display:flex;align-items:center;justify-content:center;
      color:#fff;font-weight:700;font-size:14px;
      box-shadow:0 4px 12px rgba(99,102,241,0.4);
    }
    .nav-username{
      color:var(--text);font-size:14px;font-weight:600;
    }
    .dropdown-menu{
      position:absolute;top:calc(100% + 0.5rem);right:0;
      background:rgba(26,26,36,0.95);backdrop-filter:blur(20px);
      border:1px solid rgba(99,102,241,0.2);border-radius:16px;
      padding:0.5rem;min-width:200px;
      box-shadow:0 12px 32px rgba(0,0,0,0.5);
      opacity:0;visibility:hidden;transform:translateY(-10px);
      transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
      z-index:1000;
    }
    .nav-user-dropdown:hover .dropdown-menu{
      opacity:1;visibility:visible;transform:translateY(0);
    }
    .dropdown-menu a,.dropdown-menu button{
      display:flex;align-items:center;gap:0.75rem;
      padding:0.75rem 1rem;border-radius:12px;
      color:var(--text);text-decoration:none;
      font-size:14px;font-weight:500;
      transition:all 0.2s;width:100%;
      background:none;border:none;cursor:pointer;
      font-family:inherit;text-align:left;
    }
    .dropdown-menu a:hover{
      background:rgba(99,102,241,0.15);
      color:var(--primary);
    }
    .dropdown-menu button:hover{
      background:rgba(239,68,68,0.15);
      color:var(--danger);
    }
    .dropdown-divider{
      height:1px;background:rgba(99,102,241,0.1);
      margin:0.5rem 0;
    }
    .container{
      max-width:1600px;margin:2rem auto;padding:0 2.5rem;
      position:relative;z-index:1;animation:slideIn 0.5s ease;
    }
    .card{
      background:rgba(26,26,36,0.5);backdrop-filter:blur(20px);
      border:1px solid rgba(99,102,241,0.15);border-radius:20px;
      padding:2rem;margin:1.5rem 0;
      transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
      position:relative;overflow:hidden;
    }
    .card::before{
      content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;
      background:linear-gradient(90deg,transparent,rgba(99,102,241,0.05),transparent);
      transition:left 0.6s;
    }
    .card:hover{
      border-color:rgba(99,102,241,0.3);
      box-shadow:0 20px 60px rgba(0,0,0,0.5);
      transform:translateY(-4px);
    }
    .card:hover::before{left:100%}
    input,select,textarea{
      font:inherit;padding:0.875rem 1.25rem;
      border:1px solid rgba(99,102,241,0.2);
      border-radius:12px;background:rgba(18,18,26,0.6);
      color:var(--text);transition:all 0.2s;width:100%;margin:0.5rem 0;
    }
    input:focus,select:focus,textarea:focus{
      outline:none;border-color:var(--primary);
      box-shadow:0 0 0 4px rgba(99,102,241,0.15);
      background:rgba(18,18,26,0.9);
    }
    button:not(.nav-center a):not(.dropdown-menu button),.btn{
      background:linear-gradient(135deg,var(--primary),var(--secondary));
      color:#fff;border:none;cursor:pointer;
      padding:0.625rem 1.25rem;
      border-radius:8px;text-decoration:none;display:inline-block;
      font-weight:500;font-size:13px;transition:all 0.2s;
      font-family:inherit;position:relative;overflow:hidden;
      box-shadow:0 2px 8px rgba(99,102,241,0.25);
    }
    button:not(.nav-center a):not(.dropdown-menu button)::after,.btn::after{
      content:'';position:absolute;top:50%;left:50%;width:0;height:0;
      border-radius:50%;background:rgba(255,255,255,0.2);
      transition:width 0.4s,height 0.4s;transform:translate(-50%,-50%);
    }
    button:not(.nav-center a):not(.dropdown-menu button):hover::after,.btn:hover::after{width:300px;height:300px}
    button:not(.nav-center a):not(.dropdown-menu button):hover,.btn:hover{
      transform:translateY(-1px);
      box-shadow:0 4px 12px rgba(99,102,241,0.35);
    }
    .btn-secondary{
      background:rgba(71,85,105,0.8);
      box-shadow:0 2px 8px rgba(0,0,0,0.15);
    }
    .btn-secondary:hover{
      background:rgba(71,85,105,0.9);
      box-shadow:0 4px 12px rgba(0,0,0,0.25);
    }
    .btn-danger{
      background:linear-gradient(135deg,var(--danger),#dc2626);
      box-shadow:0 2px 8px rgba(239,68,68,0.25);
    }
    table{
      width:100%;border-collapse:separate;border-spacing:0;
      margin:1.5rem 0;border-radius:16px;overflow:hidden;
    }
    th,td{padding:1.125rem;text-align:left;border-bottom:1px solid rgba(99,102,241,0.1)}
    th{
      background:rgba(99,102,241,0.08);color:var(--text);font-weight:700;
      font-size:12px;text-transform:uppercase;letter-spacing:0.08em;
    }
    tr:hover td{background:rgba(99,102,241,0.05)}
    .item-card{
      background:rgba(26,26,36,0.4);
      border:1px solid rgba(99,102,241,0.15);
      border-radius:16px;padding:1.75rem;margin:1rem 0;
      transition:all 0.3s;
    }
    .item-card:hover{
      border-color:rgba(99,102,241,0.4);
      box-shadow:0 12px 32px rgba(0,0,0,0.4);
      transform:translateY(-3px);
    }
    h1{
      font-size:2.75rem;font-weight:900;letter-spacing:-0.04em;
      margin-bottom:0.75rem;color:var(--text);
    }
    h2{font-size:2rem;font-weight:800;margin-bottom:1rem;color:var(--text)}
    h3{font-size:1.5rem;font-weight:700;margin-bottom:0.75rem;color:var(--text)}
    h4{font-size:1.25rem;font-weight:600;margin-bottom:0.5rem;color:var(--text)}
    p{color:var(--text-dim);line-height:1.7}
    label{
      display:block;color:var(--text);font-weight:600;
      font-size:13px;margin-bottom:0.5rem;letter-spacing:0.02em;
    }
    .messages{list-style:none;padding:0}
    .messages li{
      background:linear-gradient(135deg,rgba(16,185,129,0.15),rgba(16,185,129,0.08));
      border:1px solid rgba(16,185,129,0.3);border-left:4px solid var(--success);
      padding:1.125rem 1.5rem;border-radius:12px;margin:1rem 0;
      animation:slideIn 0.4s ease;font-weight:500;
    }
    .badge{
      display:inline-block;padding:0.5rem 1rem;border-radius:20px;
      font-size:12px;font-weight:700;letter-spacing:0.03em;
    }
    .badge-primary{
      background:rgba(99,102,241,0.2);color:var(--primary);
      border:1px solid rgba(99,102,241,0.3);
    }
    .badge-warning{
      background:rgba(245,158,11,0.2);color:var(--warning);
      border:1px solid rgba(245,158,11,0.3);
    }
    .stat-card{
      text-align:center;padding:2.5rem;border-radius:20px;
      transition:all 0.4s;position:relative;overflow:hidden;
      box-shadow:0 8px 32px rgba(0,0,0,0.3);
    }
    .stat-card::before{
      content:'';position:absolute;top:0;left:0;right:0;bottom:0;
      background:rgba(255,255,255,0.05);opacity:0;transition:opacity 0.3s;
    }
    .stat-card:hover::before{opacity:1}
    .stat-card:hover{
      transform:translateY(-8px);
      box-shadow:0 24px 48px rgba(0,0,0,0.6);
    }
    .meal-group{
      background:rgba(26,26,36,0.4);
      border:1px solid rgba(99,102,241,0.15);
      border-radius:20px;padding:2rem;margin:1.5rem 0;
      transition:all 0.2s;
    }
    .meal-group:hover{border-color:rgba(99,102,241,0.3)}
    .meal-group h4{
      color:var(--text);font-size:1.25rem;font-weight:700;
      margin-bottom:1.5rem;display:flex;align-items:center;gap:1rem;
    }
    @media(max-width:1024px){
      .nav-center{flex-wrap:wrap;justify-content:center}
      .nav-brand{display:none}
    }
    @media(max-width:768px){
      nav{flex-direction:column;gap:1rem;padding:1rem}
      .nav-center{width:100%}
      .container{padding:0 1rem;margin:1.5rem auto}
      h1{font-size:2rem}
      .card{padding:1.5rem}
    }
  </style>
  {% block head %}{% endblock %}
</head>
<body>
<header>
  <nav>
    <div class="nav-brand">
      <div class="nav-brand-logo">FA</div>
      <div class="nav-brand-text">Fitness Arc</div>
    </div>
    
    <div class="nav-center">
      <a href="{% url 'common:index' %}" {% if request.resolver_match.url_name == 'index' and request.resolver_match.namespace == 'common' %}class="active"{% endif %}>Accueil</a>
      {% if user.is_authenticated %}
        <a href="{% url 'dashboard:index' %}" {% if request.resolver_match.namespace == 'dashboard' %}class="active"{% endif %}>Dashboard</a>
      {% endif %}
      <a href="{% url 'workouts:exercise_list' %}" {% if request.resolver_match.url_name == 'exercise_list' %}class="active"{% endif %}>Exercices</a>
      <a href="{% url 'workouts:template_list' %}" {% if request.resolver_match.url_name == 'template_list' or request.resolver_match.url_name == 'template_detail' %}class="active"{% endif %}>Workouts</a>
      <a href="{% url 'nutrition_today' %}" {% if 'nutrition' in request.path %}class="active"{% endif %}>Nutrition</a>
    </div>
    
    <div class="nav-right">
      {% if user.is_authenticated %}
        <!-- Friends Icon -->
        <div class="nav-friends-icon" style="position:relative">
          <a href="{% url 'accounts:friends_list' %}" style="display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background:rgba(26,26,36,0.6);border:1px solid rgba(99,102,241,0.2);transition:all 0.2s;text-decoration:none">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color:var(--primary)">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
              <circle cx="9" cy="7" r="4"/>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
            {% if pending_requests_count > 0 %}
            <span style="position:absolute;top:-4px;right:-4px;background:var(--danger);color:#fff;width:18px;height:18px;border-radius:50%;font-size:10px;font-weight:700;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(239,68,68,0.5)">
              {{ pending_requests_count }}
            </span>
            {% endif %}
          </a>
        </div>
        
        <div class="nav-user-dropdown">
          <div class="nav-user">
            <div class="nav-avatar">{{ user.username.0|upper }}</div>
            <span class="nav-username">{{ user.username }}</span>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" style="opacity:0.6">
              <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          
          <div class="dropdown-menu">
            <a href="{% url 'accounts:profile' %}">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
              </svg>
              Mon Profil
            </a>
            <div class="dropdown-divider"></div>
            <form method="post" action="{% url 'accounts:logout' %}" style="margin:0">
              {% csrf_token %}
              <button type="submit">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                  <polyline points="16 17 21 12 16 7"/>
                  <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
                DÃ©connexion
              </button>
            </form>
          </div>
        </div>
      {% else %}
        <a href="{% url 'accounts:login' %}" class="btn">Connexion</a>
      {% endif %}
    </div>
  </nav>
</header>
<main class="container">
  {% if messages %}
    <ul class="messages">
      {% for message in messages %}
        <li>{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}
  {% block content %}{% endblock %}
</main>
</body>
</html>
